{% extends "base.html" %}

{% block title %}Checkout | MPE UK Ltd{% endblock %}

{% block content %}
<section class="simple-hero">
  <div class="container">
    <h1>Checkout</h1>
    <p class="muted">Enter your details and submit your order request.</p>
  </div>
</section>

<section class="simple-section">
  <div class="container">
    <div class="card">
      <div class="card__pad" style="display:grid; grid-template-columns: 1fr 0.9fr; gap:22px;">
        <div>
          <form method="post" class="form">
            {% csrf_token %}

            <h2 style="margin-top:0;">Contact</h2>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
              <div>{{ form.name.label_tag }}{{ form.name }}</div>
              <div>{{ form.company.label_tag }}{{ form.company }}</div>
              <div>{{ form.email.label_tag }}{{ form.email }}</div>
              <div>{{ form.phone.label_tag }}{{ form.phone }}</div>
            </div>

            <h2 style="margin-top:18px;">Address</h2>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
              <div style="grid-column:1/-1;">{{ form.address_label.label_tag }}{{ form.address_label }}</div>
              <div style="grid-column:1/-1;">{{ form.address_1.label_tag }}{{ form.address_1 }}</div>
              <div style="grid-column:1/-1;">{{ form.address_2.label_tag }}{{ form.address_2 }}</div>
              <div>{{ form.city.label_tag }}{{ form.city }}</div>
              <div>{{ form.county.label_tag }}{{ form.county }}</div>
              <div>{{ form.postcode.label_tag }}{{ form.postcode }}</div>
              <div>{{ form.country.label_tag }}{{ form.country }}</div>
            </div>

            <h2 style="margin-top:18px;">Purchase Order</h2>
            <div style="display:grid; grid-template-columns: 1fr; gap:12px;">
              <div>{{ form.order_number.label_tag }}{{ form.order_number }}</div>
              <div>{{ form.notes.label_tag }}{{ form.notes }}</div>
            </div>

            <div style="margin-top:16px; display:flex; gap:12px; flex-wrap:wrap;">
              <a class="btn btn--ghost" href="{% url 'cart_view' %}">
                <i class="fa-solid fa-arrow-left"></i> Back to basket
              </a>
              <button class="btn btn--primary" type="submit">
                <i class="fa-solid fa-paper-plane"></i> Place order
              </button>
            </div>
          </form>
        </div>

        <div>
          <h2 style="margin-top:0;">Summary</h2>
          <div class="card" style="border:1px solid rgba(0,0,0,.06);">
            <div class="card__pad">
              {% for it in items %}
                <div style="display:flex; justify-content:space-between; gap:12px; padding:8px 0; border-bottom:1px solid var(--bg);">
                  <div style="font-weight:800;">{{ it.product.name }}</div>
                  <div class="muted">x{{ it.qty }}</div>
                </div>
              {% endfor %}
              <div style="margin-top:12px; display:flex; justify-content:space-between; font-weight:900;">
                <span>Total items</span>
                <span>{{ total_qty }}</span>
              </div>
              {% if show_prices %}
                <p class="muted" style="margin:10px 0 0 0;">Prices shown where available. Some items may be “on request”.</p>
              {% else %}
                <p class="muted" style="margin:10px 0 0 0;">Prices are hidden. We’ll confirm pricing by email.</p>
              {% endif %}
            </div>
          </div>

          {% if user.is_authenticated and not user.is_staff %}
            <div class="card" style="margin-top:14px;">
              <div class="card__pad">
                <h3 style="margin-top:0;">You’re signed in</h3>
                <p class="muted" style="margin-bottom:0;">We’ve pre-filled your details where possible.</p>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>

<style>
@media (max-width: 980px){
  .card__pad[style*="grid-template-columns"]{ grid-template-columns:1fr !important; }
}
form input, form textarea{
  width:100%;
  padding:10px 12px;
  border:1px solid #ddd;
  border-radius:12px;
}
form label{ font-weight:800; display:block; margin:10px 0 6px; }
</style>
{% endblock %}
