{% extends "base.html" %}
{% load static %}
{% block title %}MPE UK Ltd | Food Packaging Machinery{% endblock %}

{% block content %}
<section class="hero">
  <div class="hero__bg"></div>

  <div class="container container--hero hero__content">
    <div class="hero-carousel" data-interval="7000" aria-roledescription="carousel">
      <div class="hero-carousel__slides">

        <!-- Slide 1: Main hero (Site config) -->
        <div class="hero-slide is-active" data-slide="0" aria-label="Slide 1">
          <div class="hero-grid">
            <div class="hero__text">
              <h1>{{ site_config.hero_title }}</h1>
              <h2>{{ site_config.hero_subtitle }}</h2>
              <p>{{ site_config.hero_description }}</p>

              <div class="hero__cta">
                <a class="btn btn--primary" href="{{ site_config.hero_button_link }}">
                  <i class="fa-solid fa-robot" aria-hidden="true"></i>
                  <span>{{ site_config.hero_button_text }}</span>
                </a>
              </div>

              <div class="hero__bullets hero__bullets--chips">
                {% if site_config.feature_1 %}
                  <span><i class="fa-solid fa-flag" aria-hidden="true"></i> {{ site_config.feature_1 }}</span>
                {% endif %}
                {% if site_config.feature_2 %}
                  <span><i class="fa-solid fa-screwdriver-wrench" aria-hidden="true"></i> {{ site_config.feature_2 }}</span>
                {% endif %}
                {% if site_config.feature_3 %}
                  <span><i class="fa-solid fa-gears" aria-hidden="true"></i> {{ site_config.feature_3 }}</span>
                {% endif %}
              </div>
            </div>

            <div class="hero__image">
              <div class="hero-media">
                {% if site_config.hero_image %}
                  <img src="{{ site_config.hero_image.url }}" alt="{{ site_config.hero_title }}" class="hero-img">
                {% else %}
                  <img src="{% static 'assets/i6.png' %}" alt="{{ site_config.hero_title }}" class="hero-img">
                {% endif %}
              </div>
            </div>
          </div>
        </div>

        <!-- Slide 2..N: Featured machines -->
        {% for m in featured_machines %}
          <div class="hero-slide" data-slide="{{ forloop.counter }}" aria-label="Slide {{ forloop.counter|add:1 }}">
            <div class="hero-grid">
              <div class="hero__text">
                <h1>{{ m.name }}</h1>
                {% if m.tagline %}<h2>{{ m.tagline }}</h2>{% endif %}
                {% if m.description %}
                  <p>{{ m.description|truncatechars:160 }}</p>
                {% else %}
                  <p>High-performance packaging machinery built for reliability, uptime, and easy cleaning.</p>
                {% endif %}

                <div class="hero__cta">
                  {% if m.external_link %}
                    <a class="btn btn--primary" href="{{ m.external_link }}" target="_blank" rel="noopener">
                      <i class="fa-solid fa-arrow-up-right-from-square" aria-hidden="true"></i>
                      <span>View details</span>
                    </a>
                  {% else %}
                    <a class="btn btn--primary" href="#machines">
                      <i class="fa-solid fa-eye" aria-hidden="true"></i>
                      <span>View machines</span>
                    </a>
                  {% endif %}
                </div>

                <div class="hero__bullets hero__bullets--chips">
                  <span><i class="fa-solid fa-bolt" aria-hidden="true"></i> Built for high uptime</span>
                  <span><i class="fa-solid fa-shield-halved" aria-hidden="true"></i> Designed for hygiene</span>
                  <span><i class="fa-solid fa-screwdriver-wrench" aria-hidden="true"></i> UK service support</span>
                </div>
              </div>

              <div class="hero__image">
                <div class="hero-media">
                  {% if m.image %}
                    <img src="{{ m.image.url }}" alt="{{ m.name }}" class="hero-img">
                  {% else %}
                    <img src="{% static 'assets/i6.png' %}" alt="{{ m.name }}" class="hero-img">
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}

        <!-- Final slide: Updates -->
        <div class="hero-slide hero-slide--full" data-slide="news" aria-label="Updates">
          <div class="hero-grid">
            <div class="hero__text">
              <h1>Updates &amp; New Builds</h1>
              <h2>Follow progress, installs, and product updates</h2>
              <p>We share new machine builds, upgrades, and support updates regularly. The quickest way to keep up is via our social channels.</p>

              <div class="hero__cta">
                {% if site_config.linkedin_url %}
                  <a class="btn btn--primary" href="{{ site_config.linkedin_url }}" target="_blank" rel="noopener">
                    <i class="fa-brands fa-linkedin" aria-hidden="true"></i>
                    <span>Follow on LinkedIn</span>
                  </a>
                {% else %}
                  <a class="btn btn--primary" href="{% url 'contact' %}">
                    <i class="fa-solid fa-envelope" aria-hidden="true"></i>
                    <span>Contact us</span>
                  </a>
                {% endif %}
              </div>

              <div class="hero__bullets hero__bullets--chips">
                <span><i class="fa-solid fa-newspaper" aria-hidden="true"></i> New installs</span>
                <span><i class="fa-solid fa-wrench" aria-hidden="true"></i> Support notes</span>
                <span><i class="fa-solid fa-gear" aria-hidden="true"></i> Product updates</span>
              </div>
            </div>

            <div class="hero__image">
              <div class="hero-media">
                <img src="{% static 'assets/i6.png' %}" alt="MPE machinery" class="hero-img">
              </div>
            </div>
          </div>
        </div>

      </div>

      <button class="hero-carousel__nav hero-carousel__nav--prev" type="button" aria-label="Previous slide">
        <i class="fa-solid fa-chevron-left" aria-hidden="true"></i>
      </button>
      <button class="hero-carousel__nav hero-carousel__nav--next" type="button" aria-label="Next slide">
        <i class="fa-solid fa-chevron-right" aria-hidden="true"></i>
      </button>

      <div class="hero-carousel__dots" aria-label="Carousel navigation"></div>
    </div>
  </div>
</section>
<section class="section section--alt" id="machines">
  <div class="container">
    <div class="section__head">
      <div>
        <h2>Our Machinery Range</h2>
        <p>Comprehensive sealing solutions for every production scale.</p>
      </div>
    </div>

    <div class="grid machine-grid">
      {% for machine in machines %}
        <article class="card machine">
          <div class="thumb">
            {% if machine.image %}
              <img src="{{ machine.image.url }}" alt="{{ machine.name }}">
            {% else %}
              <img src="{% static 'assets/image-coming-soon.png' %}" alt="{{ machine.name }}">
            {% endif %}
          </div>

          <div class="card__pad">
            <h3>{{ machine.name }}</h3>
            <p>{{ machine.tagline }}</p>

            <div class="actions">
              {% if machine.spec_pdf %}
                <a class="link" href="{{ machine.spec_pdf.url }}" target="_blank" rel="noopener">
                  <i class="fa-solid fa-file-pdf"></i> Download Spec Sheet
                </a>
              {% endif %}

              {% if machine.external_link %}
                <a class="link" href="{{ machine.external_link }}" target="_blank" rel="noopener">
                  <i class="fa-solid fa-arrow-up-right-from-square"></i> Learn more
                </a>
              {% endif %}
            </div>
          </div>
        </article>
      {% empty %}
        <div class="card" style="grid-column:1 / -1;">
          <div class="card__pad">
            <h3 style="margin:0;color:var(--text-primary);">No machines added yet</h3>
            <p class="muted" style="margin:12px 0 0 0;">Add your machines in <a href="/admin/" class="link">Admin</a> → Machine products.</p>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="section__head">
      <div>
        <h2>Global Distribution Network</h2>
        <p>Proudly serving the food industry worldwide.</p>
      </div>
    </div>

    <div class="grid">
      <div class="card kpi">
        <div class="card__pad">
          <div class="card__icon"><i class="fa-solid fa-location-dot"></i></div>
          <h3>UK HQ</h3>
          <p>Manufacturing &amp; Sales</p>
        </div>
      </div>

      <div class="card kpi">
        <div class="card__pad">
          <div class="card__icon"><i class="fa-solid fa-flag-usa"></i></div>
          <h3>USA</h3>
          <p>Distribution Partners</p>
        </div>
      </div>

      <div class="card kpi">
        <div class="card__pad">
          <div class="card__icon"><i class="fa-solid fa-maple-leaf"></i></div>
          <h3>Canada</h3>
          <p>Sales &amp; Support</p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section section--alt">
  <div class="container">
    <div class="card" style="background:linear-gradient(135deg, var(--brand) 0%, var(--brand2) 100%); border:none; box-shadow:var(--shadow-lg);">
      <div class="card__pad" style="display:flex; justify-content:space-between; gap:28px; align-items:center; flex-wrap:wrap; padding:44px 36px;">
        <div style="flex:1; min-width:280px;">
          <h2 style="margin:0 0 14px 0; color:#fff; font-size:2rem; font-weight:800; letter-spacing:-.02em;">Ready to upgrade your packaging line?</h2>
          <p style="margin:0; color:rgba(255,255,255,.95); font-size:1.08rem; line-height:1.7;">Tell us what you're packing and your required output — we'll recommend the perfect machine for your needs.</p>
          <div style="margin-top:24px; display:flex; gap:18px; flex-wrap:wrap;">
            <span style="display:inline-flex; align-items:center; gap:10px; color:rgba(255,255,255,.98); font-weight:600; font-size:.95rem;">
              <i class="fa-solid fa-check-circle"></i>
              <span>Free consultation</span>
            </span>
            <span style="display:inline-flex; align-items:center; gap:10px; color:rgba(255,255,255,.98); font-weight:600; font-size:.95rem;">
              <i class="fa-solid fa-check-circle"></i>
              <span>Expert advice</span>
            </span>
            <span style="display:inline-flex; align-items:center; gap:10px; color:rgba(255,255,255,.98); font-weight:600; font-size:.95rem;">
              <i class="fa-solid fa-check-circle"></i>
              <span>Fast response</span>
            </span>
          </div>
        </div>
        <a class="btn" href="{% url 'contact' %}" style="background:#fff; color:var(--brand) !important; font-weight:800; padding:16px 32px; flex-shrink:0;">
          <i class="fa-solid fa-calendar-check" style="color:var(--brand2) !important;"></i> 
          <span>GET A QUOTE</span>
        </a>
      </div>
    </div>
  </div>
</section>

<style>
  @media (max-width: 640px){
    .section .card > [style*="padding:44px"]{
      padding:32px 24px !important;
    }
    .section .card [style*="flex:1"]{
      min-width:100% !important;
    }
    .section .card .btn{
      width:100%;
      justify-content:center;
    }
  }
</style>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'hero_carousel.js' %}"></script>
{% endblock %}